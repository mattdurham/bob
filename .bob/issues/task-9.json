{
  "id": "task-9",
  "title": "Add mcp-filesystem-server installation to make install-mcp commands",
  "description": "## Problem\nBob's installation only registers Bob itself as an MCP server. Users don't get the filesystem server which provides useful file operations through MCP.\n\n## Goals\nEnhance `make install-mcp` and `make install-mcp-no-github` to:\n1. Automatically install mcp-filesystem-server from https://github.com/mark3labs/mcp-filesystem-server\n2. Interactively prompt user for allowed directory\n3. Register filesystem server alongside Bob in MCP configuration\n4. Provide sensible defaults and validation\n\n## Implementation\n\n### 1. Update Makefile Targets\n\nAdd filesystem server installation to both targets:\n- `install-mcp` - Install Bob + filesystem server (with GitHub)\n- `install-mcp-no-github` - Install Bob + filesystem server (without GitHub)\n\n### 2. Interactive Prompt Script\n\nCreate bash function to prompt for directory:\n```bash\nprompt_filesystem_dir() {\n    echo \"üóÇÔ∏è  Configure MCP Filesystem Server\"\n    echo \"\"\n    echo \"The filesystem server allows Claude to read/write files in a directory.\"\n    echo \"Choose an allowed directory:\"\n    echo \"\"\n    echo \"  1. Current project directory: $(pwd)\"\n    echo \"  2. Home directory: $HOME\"\n    echo \"  3. Custom directory (you specify)\"\n    echo \"  4. Skip filesystem server installation\"\n    echo \"\"\n    read -p \"Select option (1-4): \" choice\n    \n    case $choice in\n        1)\n            ALLOWED_DIR=\"$(pwd)\"\n            ;;\n        2)\n            ALLOWED_DIR=\"$HOME\"\n            ;;\n        3)\n            read -p \"Enter custom directory path: \" ALLOWED_DIR\n            # Validate directory exists\n            if [ ! -d \"$ALLOWED_DIR\" ]; then\n                echo \"‚ùå Directory does not exist: $ALLOWED_DIR\"\n                exit 1\n            fi\n            ;;\n        4)\n            echo \"‚è≠Ô∏è  Skipping filesystem server installation\"\n            return 1\n            ;;\n        *)\n            echo \"‚ùå Invalid option\"\n            exit 1\n            ;;\n    esac\n    \n    # Convert to absolute path\n    ALLOWED_DIR=$(cd \"$ALLOWED_DIR\" \u0026\u0026 pwd)\n    \n    echo \"‚úÖ Will allow access to: $ALLOWED_DIR\"\n    read -p \"Confirm? (y/n): \" confirm\n    \n    if [ \"$confirm\" != \"y\" ]; then\n        echo \"‚ùå Installation cancelled\"\n        exit 1\n    fi\n    \n    echo \"$ALLOWED_DIR\"\n}\n```\n\n### 3. Installation Logic\n\n```bash\n# In install-mcp target\ninstall-mcp: build\n\t@echo \"üè¥‚Äç‚ò†Ô∏è Installing Bob as MCP server...\"\n\t\n\t# Install Bob\n\t@BOB_INSTALL_DIR=\"$$HOME/.bob\"; \\\n\tBOB_PATH=\"$$BOB_INSTALL_DIR/bob\"; \\\n\tmkdir -p \"$$BOB_INSTALL_DIR\"; \\\n\tcp cmd/bob/bob \"$$BOB_PATH\"; \\\n\tchmod +x \"$$BOB_PATH\"; \\\n\techo \"‚úÖ Installed Bob to $$BOB_PATH\"\n\t\n\t# Prompt for filesystem directory\n\t@ALLOWED_DIR=$$(prompt_filesystem_dir); \\\n\tif [ -n \"$$ALLOWED_DIR\" ]; then \\\n\t\tinstall_filesystem_server \"$$ALLOWED_DIR\"; \\\n\tfi\n\t\n\t# Configure MCP\n\t@echo \"üì¶ Configuring MCP servers...\"\n\t@claude mcp remove bob 2\u003e/dev/null || true\n\t@claude mcp add bob -- \"$$HOME/.bob/bob\" --serve\n\t\n\t@if [ -n \"$$ALLOWED_DIR\" ]; then \\\n\t\tclaude mcp remove filesystem 2\u003e/dev/null || true; \\\n\t\tclaude mcp add filesystem -- npx -y @mark3labs/mcp-filesystem-server \"$$ALLOWED_DIR\"; \\\n\tfi\n\t\n\t@echo \"‚úÖ MCP configuration complete\"\n```\n\n### 4. Filesystem Server Installation\n\n```bash\ninstall_filesystem_server() {\n    local allowed_dir=\"$1\"\n    \n    echo \"üì¶ Installing mcp-filesystem-server...\"\n    \n    # Check if npx is available\n    if ! command -v npx \u0026\u003e /dev/null; then\n        echo \"‚ùå npx not found. Please install Node.js first.\"\n        exit 1\n    fi\n    \n    # Test filesystem server is available\n    if ! npx -y @mark3labs/mcp-filesystem-server --version \u0026\u003e /dev/null; then\n        echo \"‚ùå Failed to install mcp-filesystem-server\"\n        exit 1\n    fi\n    \n    echo \"‚úÖ Filesystem server ready\"\n    echo \"   Allowed directory: $allowed_dir\"\n}\n```\n\n### 5. MCP Configuration Format\n\nAfter installation, `.claude/mcp_config.json` should contain:\n\n```json\n{\n  \"mcpServers\": {\n    \"bob\": {\n      \"command\": \"/home/user/.bob/bob\",\n      \"args\": [\"--serve\"]\n    },\n    \"filesystem\": {\n      \"command\": \"npx\",\n      \"args\": [\"-y\", \"@mark3labs/mcp-filesystem-server\", \"/allowed/directory\"]\n    }\n  }\n}\n```\n\n## Files to Modify\n- `Makefile` - Add filesystem server installation logic\n- `README.md` - Document filesystem server installation\n- `CLAUDE.md` - Update MCP configuration examples\n\n## Success Criteria\n- `make install-mcp` prompts for directory\n- User can choose from 4 options (project, home, custom, skip)\n- Invalid directories are rejected with clear error\n- Filesystem server is registered in MCP config\n- Claude can access files in allowed directory\n- Clear documentation of what was installed\n\n## Edge Cases\n- User doesn't have Node.js/npx installed\n- User selects non-existent directory\n- User cancels during confirmation\n- Filesystem server package not available\n- Permission issues with chosen directory\n- User wants to change allowed directory later\n\n## Security Considerations\n- Always convert to absolute paths (prevent relative path issues)\n- Validate directory exists before allowing\n- Clear warning about what directory access means\n- Document how to change/revoke access later\n- Never allow root directory (/) by default\n\n## User Experience\n\nExample installation flow:\n```\n$ make install-mcp\nüî® Building Bob...\n‚úÖ Bob built: cmd/bob/bob\nüè¥‚Äç‚ò†Ô∏è Installing Bob as MCP server...\n‚úÖ Installed Bob to /home/user/.bob/bob\n\nüóÇÔ∏è  Configure MCP Filesystem Server\n\nThe filesystem server allows Claude to read/write files in a directory.\nChoose an allowed directory:\n\n  1. Current project directory: /home/user/projects/bob\n  2. Home directory: /home/user\n  3. Custom directory (you specify)\n  4. Skip filesystem server installation\n\nSelect option (1-4): 1\n‚úÖ Will allow access to: /home/user/projects/bob\nConfirm? (y/n): y\n\nüì¶ Installing mcp-filesystem-server...\n‚úÖ Filesystem server ready\n   Allowed directory: /home/user/projects/bob\n\nüì¶ Configuring MCP servers...\n‚úÖ Bob configured as MCP server\n‚úÖ Filesystem server configured\n\n‚úÖ MCP configuration complete\n\nüîÑ Restart Claude CLI to activate both servers\n```\n\n## Documentation to Add\n\n### README.md\n```markdown\n## MCP Servers Installed\n\nWhen you run `make install-mcp`, Bob installs two MCP servers:\n\n1. **Bob** - Workflow orchestration and task management\n2. **Filesystem** - File read/write operations (optional)\n\nThe filesystem server requires you to specify an allowed directory\nduring installation. You can skip it if you don't need file operations.\n\n### Changing Filesystem Directory\n\nTo change the allowed directory, edit `~/.claude/mcp_config.json`:\n\n```json\n{\n  \"mcpServers\": {\n    \"filesystem\": {\n      \"args\": [\"-y\", \"@mark3labs/mcp-filesystem-server\", \"/new/directory\"]\n    }\n  }\n}\n```\n\nThen restart Claude CLI.\n```\n\n## Related\n- Enhances Bob installation with useful filesystem capabilities\n- Provides interactive, user-friendly installation\n- Follows security best practices for directory access",
  "type": "feature",
  "priority": "medium",
  "state": "completed",
  "tags": [
    "enhancement",
    "installation",
    "mcp",
    "filesystem"
  ],
  "createdAt": "2026-02-09T17:18:06.863312249-05:00",
  "updatedAt": "2026-02-09T18:48:42.141481354-05:00",
  "completedAt": "2026-02-09T18:48:42.141481279-05:00"
}